---
layout: post
title: 【曹操傳】豪華版 2014(數據以及存檔文件修改)
tags: [CaoCaoZuan, Mod]
---

原文出自 [豪华曹操传2014 (数据以及存档文件修改)](https://blog.csdn.net/xueerfei008/article/details/43984645)，僅繁體化並調整排版。

<!-- more -->

假期在家閒的無事，想起以前玩過曹操傳這種戰棋游戲，無意間發現有個論壇製作了最新的版本：《豪華曹操傳2014》，故事跟之前的版本不太一樣，數據以及存檔都有了變化，所以以前的修改器都用不了了，雖然選擇了最簡單的模式，但是依然發現打不過…所以只好研究了數據文件 `Data.e5` 以及**存檔文件夾 S** 下的文件，各種修改終於通關，現在將數據格式記錄一下，有時間了再做一個修改器吧。

`Data.e5` 文件記錄了人物屬性，裝備屬性等等很多資源，如下圖所示：

其實載入數據文件就可以通過右邊的漢語大概能猜到，這個文件中還記錄了 AI 的一些數據，包括將領以及士兵，不同種類的武器和技能等等，我只是為了通關，所以只研究了幾個基本屬性，其他的沒有看。

![data](https://i.imgur.com/FKCd1Zd.png)

用紅色標出來的 `B2 DC B2 D9` 就是曹操的漢語編碼，然後跳過後邊的 *12* 個位元組 `00`，第 *019C* 位元組 `19` 是曹操這個將領的編碼（猜想而已，後邊將領的數據很像但也有例外），也有可能使用好幾個位元組連在一起表示將領編號，不過這個並不影響分析。第 *019E~01A2* 這個五個位元組表示將領的武力，統率，敏捷，智力，運氣五大屬性（前兩個順序是對的，後邊三個屬性可能順序不對，不過我都改成了全 `FF`，所以就變成了下圖：）後面緊跟的是初始生命值，用兩個位元組表示第 *01A3 ~ 01A4* 兩個位元組 `10 27` 表示，不過這裡需要倒過來，實際在程式中組裝是 `0x2710`，正好是十進制的 `10000`（我已經將初始生命值改為了 `10000`）。在數據資源文件中改過的就這些了，其他將領的數據修改類似不再重復。

![info](https://i.imgur.com/YeJr7n1.png)

數據資源文件修改完，還需要修改存檔文件，豪華版的存檔跟原始版不太一樣，遊戲目錄中用 **S 文件夾** 保存存檔文件，每一個存檔分別用 4 個文件存儲（原版是 3 個，所以以前的修改器用不了）。相關數據放在了 `0XD.E5S` 中，其中 `X` 是存檔的編號。如下圖所示：

![setting](https://i.imgur.com/yPyXjEz.png)

打開存檔文件，定位到 *14F0* 位元組處

+ 從 *14F4 ~ 14FD* 這 10 個位元組，分為 5 類，對應於左上圖的攻擊，精神，防禦，爆發力以及士氣，兩個位元組為一組，首位元組為要加成的數字，第二個位元組要麼為 `01`，要麼為 `00`，`01` 表示加，`00` 表示不加，可能跟將領的模式有關吧。
+ `14FE ~ 1502` 這連續 5 個位元組代表將領的屬性，之前在數據文件中修改過了，所以這裡都是全 `FF`，即 `255`。
+ `1503 ~ 1506` 這四個位元組不知道什麼用。
+ `1507` 這個位元組表示將領等級，最高 `255`，不過建議不要隨意修改這個值，因為電腦的級別是隨著將領的級別而變的，所以改了其實沒啥用。
+ `1508` 這個位元組表示將領當前經驗等級。
+ 從 `1509 ~ 1511` 這 9 個位元組三個一組，分別代表武器，護甲以及坐騎，以武器為例，其中第一個位元組代表武器編碼，這裡 `1F` 表示青龍偃月刀，第二個位元組 `DD` 表示武器等級（這裡我改為了 `221` 級），第三個位元組表示當前武器所獲得的經驗（武器裝備也要升級），護甲是一樣的，不過坐騎沒有等級之說，所以只需要修改第一個編碼就可以了。這裡我修改了護具代碼，`0B` 表示干將莫邪（因為可以改存檔了，就不需要護具了，護具這也改成武器了，這個武器可以行動兩次），坐騎代碼 `46` 表示赤兔馬，先手攻擊，也很好，我所有武將都改為了兩個武器，一個赤兔，所有謀士武器都改為了 `26`（窮奇羽扇），可以連續法術攻擊，如果將智力改為 `255`，第二次攻擊的傷害在 *2000 ~ 3000*，幾乎放一個群攻技能就可以秒一群人，後面的關卡幾乎都是靠著謀士通關的。

豪華版感覺難度太大了，不得不改數據。假期在家啥也沒幹，過幾天也該去上班了。

末了，祝大家新年快樂！～～～